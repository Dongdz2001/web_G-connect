import { GC_LICH_TUANService } from "modules/GC_LICH_TUAN/GC_LICH_TUANService";
import { Button } from "primereact/button";
import { Card } from "primereact/card";
import { Dropdown } from "primereact/dropdown";
import { InputText } from "primereact/inputtext";
import { useEffect, useState } from "react";
import { Controller, useForm } from "react-hook-form";
import { useNavigate, useParams } from "react-router-dom";

export default function CLIENT_LICH_TUANForm(props) {
  const defaultValues = {};
  const itemService = GC_LICH_TUANService;

  const labelSave = "Lưu";
  const labelClose = "Đóng";
  const linkList = "/client/CL_LICH_TUAN";
  let { id } = useParams();
  let itemId = props.id ?? id;
  let navigate = useNavigate();

  const onSubmit = async (formData) => {
    await itemService.update(itemId, formData);
    if (props.fnLoadData) props.fnLoadData();
    if (props.fnClose) props.fnClose();
    else navigate(linkList);
  };
  const close = async () => {
    if (props.fnClose) props.fnClose();
    else navigate(linkList);
    //navigate(-1);
  };
  const getFormErrorMessage = (name) => {
    return (
      errors[name] && <small className="p-error">{errors[name].message}</small>
    );
  };
  const {
    register,
    control,
    formState: { errors },
    handleSubmit,
    reset,
    watch,
    getValues,
    setValue,
  } = useForm({ defaultValues });

  const getById = async (itemId) => {
    let result = await itemService.getById(itemId);
    reset(result.data);
  };
  useEffect(() => {
    if (itemId !== "new") getById(itemId);

    getListRef_id_nguoi_thuc_hien();
  }, [window.location.href]);
  const getListRef_id_nguoi_thuc_hien = () => {
    return GC_LICH_TUANService.getAllRef_id_nguoi_thuc_hien().then((res) => {
      res.data.map((x) => {
        x.Value = x.value;
        x.Text = x.label;
      });
      console.log(res.data);
    });
  };
  return (
    <div>
      <Card title="Thêm lịch tuần, lịch thực tập">
        <form className="p-fluid" onSubmit={handleSubmit(onSubmit)}>
          <div className="row">
            <div className={props.fnClose ? "text-center" : "col-12"}>
              <Button
                label={labelSave}
                icon="fa fa-save"
                style={{ width: "100px" }}
              />
              <Button
                className="btnClose"
                style={{ width: 100 }}
                onClick={close.bind(this)}
                label={labelClose}
              ></Button>
            </div>
            <br />
            <br />

            <Controller
              name="xxx"
              control={control}
              render={({ field, fieldState }) => (
                <InputText {...field} className={"hide"} value={field.value} />
              )}
            />
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu2_sang">{"Thứ 2"}</label>
                <Controller
                  name="thu2_sang"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu2_sang", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu2_chieu">{"Title of thu2_chieu"}</label>
                <Controller
                  name="thu2_chieu"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu2_chieu", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu3_sang">{"Thứ 3"}</label>
                <Controller
                  name="thu3_sang"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu3_sang", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu3_chieu">{"Title of thu3_chieu"}</label>
                <Controller
                  name="thu3_chieu"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu3_chieu", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu4_sang">{"Thứ 4"}</label>
                <Controller
                  name="thu4_sang"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu4_sang", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu4_chieu">{"Title of thu4_chieu"}</label>
                <Controller
                  name="thu4_chieu"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu4_chieu", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu5_sang">{"Thứ 5"}</label>
                <Controller
                  name="thu5_sang"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu5_sang", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu5_chieu">{"Title of thu5_chieu"}</label>
                <Controller
                  name="thu5_chieu"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu5_chieu", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu6_sang">{"Thứ 6"}</label>
                <Controller
                  name="thu6_sang"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu6_sang", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu6_chieu">{"Title of thu6_chieu"}</label>
                <Controller
                  name="thu6_chieu"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu6_chieu", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu7_sang">{"Thứ 7"}</label>
                <Controller
                  name="thu7_sang"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu7_sang", errors)}
              </div>
            </div>
            <div className="col-12">
              <div className="col-sm-12">
                <label htmlFor="thu7_chieu">{"Title of thu7_chieu"}</label>
                <Controller
                  name="thu7_chieu"
                  control={control}
                  rules={{
                    maxLength: {
                      value: 20,
                      message: "Không quá 20 ký tự",
                    },
                    //validate: value => value === 'pwd' || "The passwords do not match",
                    //pattern: {
                    //  value: /^[a-zA-Z]+$/,
                    //  message: 'pattern'
                    //},
                  }}
                  render={({ field, fieldState }) => (
                    <InputText {...field} value={field.value ?? ""} />
                  )}
                />
                {getFormErrorMessage("thu7_chieu", errors)}
              </div>
            </div>
            <div className={props.fnClose ? "text-center" : "col-12"}>
              <Button
                label={labelSave}
                icon="fa fa-save"
                style={{ width: "100px" }}
              />
              <Button
                className="btnClose"
                style={{ width: 100 }}
                onClick={close.bind(this)}
                label={labelClose}
              ></Button>
            </div>
          </div>
        </form>
      </Card>
    </div>
  );
}
